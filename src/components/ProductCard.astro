---
import type { Product } from "../types/product";
import { url } from "../utils/url-utils";
import ImageWrapper from "./misc/ImageWrapper.astro";
import { Icon } from "astro-icon/components";

interface Props {
	product: Product;
	class?: string;
	style?: string;
}

const { product, style } = Astro.props;
const className = Astro.props.class;
---

<a
	href={url(`/product/${product.id}`)}
	class:list={[
		"card-base group overflow-hidden rounded-[var(--radius-large)] transition-all hover:scale-[1.02] hover:shadow-lg active:scale-[0.98] cursor-pointer border border-[var(--line-color)] hover:border-[var(--primary)]/50",
		className,
	]}
	style={style}
>
	<!-- 商品图片 -->
	<div class="relative w-full h-48 overflow-hidden bg-[var(--card-bg)]">
		<ImageWrapper
			src={product.image}
			alt={product.name}
			class="w-full h-full object-cover transition-transform duration-500 group-hover:scale-110"
		/>
		<div class="absolute inset-0 bg-gradient-to-t from-black/60 via-transparent to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300"></div>
		<!-- 分类标签 -->
		<div class="absolute top-3 left-3">
			<span class="px-3 py-1 text-xs font-semibold rounded-full bg-[var(--primary)]/90 text-white backdrop-blur-sm shadow-lg">
				{product.category}
			</span>
		</div>
		<!-- 价格标签 -->
		<div class="absolute top-3 right-3 opacity-0 group-hover:opacity-100 transition-opacity">
			<div class="px-3 py-1 rounded-full bg-white/90 backdrop-blur-sm">
				<span class="text-sm font-bold text-[var(--primary)]">¥{product.price.toFixed(0)}</span>
			</div>
		</div>
	</div>

	<!-- 商品信息 -->
	<div class="p-5">
		<h3 class="text-xl font-bold mb-2 text-[var(--primary)] group-hover:text-[var(--primary)] transition-colors line-clamp-2">
			{product.name}
		</h3>
		<p class="text-sm text-75 mb-4 line-clamp-2 min-h-[2.5rem] leading-relaxed">
			{product.description}
		</p>
		<div class="flex items-center justify-between pt-3 border-t border-[var(--line-color)]">
			<div class="flex items-baseline gap-1">
				<span class="text-lg text-75">¥</span>
				<span class="text-3xl font-bold text-[var(--primary)]">{product.price.toFixed(2)}</span>
			</div>
			<div class="flex items-center gap-2 px-4 py-2 rounded-lg bg-[var(--primary)]/10 text-[var(--primary)] opacity-0 group-hover:opacity-100 transition-all">
				<span class="text-sm font-semibold">立即购买</span>
				<Icon name="material-symbols:arrow-forward-rounded" class="text-lg"></Icon>
			</div>
		</div>
	</div>
</a>


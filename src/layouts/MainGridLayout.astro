---
import BackToTop from "@components/control/BackToTop.astro";
import Footer from "@components/Footer.astro";
import Navbar from "@components/Navbar.astro";
import { Icon } from "astro-icon/components";
import { siteConfig } from "../config";
import {
	BANNER_HEIGHT,
	BANNER_HEIGHT_EXTEND,
	MAIN_PANEL_OVERLAPS_BANNER_HEIGHT,
} from "../constants/constants";
import Layout from "./Layout.astro";
import Carousel from "../components/Carousel.astro";

interface Props {
	title?: string;
	banner?: string;
	description?: string;
	lang?: string;
	setOGTypeArticle?: boolean;
}

const {
	title,
	banner,
	description,
	lang,
	setOGTypeArticle,
} = Astro.props;
const hasBannerCredit =
	siteConfig.banner.enable && siteConfig.banner.credit.enable;
const hasBannerLink = !!siteConfig.banner.credit.url;

const mainPanelTop = siteConfig.banner.enable
	? `calc(${BANNER_HEIGHT}vh - ${MAIN_PANEL_OVERLAPS_BANNER_HEIGHT}rem)`
	: "5.5rem";
---

<Layout title={title} banner={banner} description={description} lang={lang} setOGTypeArticle={setOGTypeArticle}>

<!-- Navbar -->
<slot slot="head" name="head"></slot>
<div id="top-row" class="z-50 pointer-events-none relative transition-all duration-700 max-w-[var(--page-width)] px-0 md:px-4 mx-auto" class:list={[""]}>
    <div id="navbar-wrapper" class="pointer-events-auto sticky top-0 transition-all">
        <Navbar></Navbar>
    </div>
</div>

<!-- Banner -->

 <!-- 未轮播图 -->
<!-- {siteConfig.banner.enable && 
 <div id="banner-wrapper" 
 class={`absolute z-10 w-full transition duration-700 overflow-hidden`} 
 style={`top: -${BANNER_HEIGHT_EXTEND}vh`}
 >
    <ImageWrapper 
    id="banner" 
    alt="Banner image of the blog" 
    class:list={["object-cover h-full transition duration-700 opacity-0 scale-105"]}
    src={siteConfig.banner.src} position={siteConfig.banner.position}
    >
    </ImageWrapper>
</div>} -->

<!-- 轮播图 -->
{siteConfig.banner.enable && (
    <div 
      id="banner-wrapper" 
      class={`absolute z-10 w-full transition duration-700 overflow-hidden`} 
      style={`top: -${BANNER_HEIGHT_EXTEND}vh`}
    >
      <Carousel 
        id="banner" 
        class="object-cover h-full transition duration-700 opacity-0 scale-105"
        interval={7500}
        images={siteConfig.banner.src}

        
      />
    </div>
  )}


<!-- images={[
    {src:"src/assets/images/demo-bg.png", alt: "Banner image of the blog"},
      { src: "https://t.alcy.cc/moez", alt: "Banner image of the blog" },
      { src: "https://t.alcy.cc/ysz", alt: "Banner image of the blog" },
      { src: "https://t.alcy.cc/moe", alt: "Banner image of the blog" }
    ]} -->

<!-- Main content -->
<div class="absolute w-full z-30 pointer-events-none" style={`top: ${mainPanelTop}`}>
    <div class="relative max-w-[var(--page-width)] mx-auto pointer-events-auto">
        <div id="main-grid" class="transition duration-700 w-full left-0 right-0 mx-auto gap-4 px-0 md:px-4">
            <!-- Banner image credit -->
            {hasBannerCredit && <a href={siteConfig.banner.credit.url} id="banner-credit" target="_blank" rel="noopener" aria-label="Visit image source"
                                   class:list={["group onload-animation transition-all absolute flex justify-center items-center rounded-full " +
                                   "px-3 right-4 -top-[3.25rem] bg-black/60 hover:bg-black/70 h-9", {"hover:pr-9 active:bg-black/80": hasBannerLink}]}
            >
                <Icon class="text-white/75 text-[1.25rem] mr-1" name="material-symbols:copyright-outline-rounded" ></Icon>
                <div class="text-white/75 text-xs">{siteConfig.banner.credit.text}</div>
                <Icon class:list={["transition absolute text-[oklch(0.75_0.14_var(--hue))] right-4 text-[0.75rem] opacity-0",
                    {"group-hover:opacity-100": hasBannerLink}]}
                      name="fa6-solid:arrow-up-right-from-square">
                </Icon>
            </a>}

            <main id="swup-container" class="transition-swup-fade overflow-hidden">
                <div id="content-wrapper" class="onload-animation">
                    <slot></slot>
                    <div class="footer onload-animation">
                        <Footer></Footer>
                    </div>
                </div>
            </main>
        </div>

        <BackToTop></BackToTop>
    </div>
</div>

<!-- TOC placeholder for Swup -->
<div id="toc"></div>
</Layout>
